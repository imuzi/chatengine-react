{"ast":null,"code":"import _defineProperty from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/wubenqi/nebula-chat/telegram-react/src/Components/Message/Media/Location.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport RoomIcon from '@material-ui/icons/Room';\nimport { getLocationId } from '../../../Utils/Message';\nimport { getSrc } from '../../../Utils/File';\nimport { LOCATION_HEIGHT, LOCATION_SCALE, LOCATION_WIDTH, LOCATION_ZOOM } from '../../../Constants';\nimport FileStore from '../../../Stores/FileStore';\nimport './Location.css';\n\nvar Location =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Location, _React$Component);\n\n  function Location() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Location);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Location)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.onClientUpdateLocationBlob = function (update) {\n      var fileId = update.fileId;\n      var _this$props = _this.props,\n          location = _this$props.location,\n          width = _this$props.width,\n          height = _this$props.height,\n          zoom = _this$props.zoom,\n          scale = _this$props.scale;\n      var locationId = getLocationId(location, width, height, zoom, scale);\n      var file = FileStore.getLocationFile(locationId);\n      if (!file) return;\n\n      if (file.id === fileId) {\n        _this.forceUpdate();\n      }\n    };\n\n    _this.handleClick = function (event) {\n      event.stopPropagation();\n    };\n\n    return _this;\n  }\n\n  _createClass(Location, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      FileStore.on('clientUpdateLocationBlob', this.onClientUpdateLocationBlob);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      FileStore.off('clientUpdateLocationBlob', this.onClientUpdateLocationBlob);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          location = _this$props2.location,\n          width = _this$props2.width,\n          height = _this$props2.height,\n          zoom = _this$props2.zoom,\n          scale = _this$props2.scale,\n          type = _this$props2.type,\n          style = _this$props2.style,\n          title = _this$props2.title,\n          caption = _this$props2.caption;\n      if (!location) return null;\n      var locationId = getLocationId(location, width, height, zoom, scale);\n      var file = FileStore.getLocationFile(locationId);\n      var src = getSrc(file);\n      var longitude = location.longitude,\n          latitude = location.latitude;\n      var source = \"https://maps.google.com/?q=\".concat(latitude, \",\").concat(longitude);\n\n      var locationStyle = _objectSpread({\n        width: width,\n        height: height\n      }, style);\n\n      return React.createElement(\"div\", {\n        className: classNames('location', {\n          'location-message': type === 'message',\n          'location-venue': type === 'venue',\n          'location-title': title,\n          'location-caption': caption\n        }),\n        style: locationStyle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        href: source,\n        target: \"_blank\",\n        rel: \"noopener noreferrer\",\n        onClick: this.handleClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"location-wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"location-image\",\n        draggable: false,\n        alt: source,\n        src: src,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"location-icon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }, React.createElement(RoomIcon, {\n        fontSize: \"large\",\n        color: \"primary\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return Location;\n}(React.Component);\n\nLocation.propTypes = {\n  chatId: PropTypes.number,\n  messageId: PropTypes.number,\n  location: PropTypes.object.isRequired,\n  openMedia: PropTypes.func,\n  width: PropTypes.number,\n  height: PropTypes.number,\n  zoom: PropTypes.number,\n  scale: PropTypes.number\n};\nLocation.defaultProps = {\n  width: LOCATION_WIDTH,\n  height: LOCATION_HEIGHT,\n  zoom: LOCATION_ZOOM,\n  scale: LOCATION_SCALE\n};\nexport default Location;","map":{"version":3,"sources":["/Users/wubenqi/nebula-chat/telegram-react/src/Components/Message/Media/Location.js"],"names":["React","PropTypes","classNames","RoomIcon","getLocationId","getSrc","LOCATION_HEIGHT","LOCATION_SCALE","LOCATION_WIDTH","LOCATION_ZOOM","FileStore","Location","onClientUpdateLocationBlob","update","fileId","props","location","width","height","zoom","scale","locationId","file","getLocationFile","id","forceUpdate","handleClick","event","stopPropagation","on","off","type","style","title","caption","src","longitude","latitude","source","locationStyle","Component","propTypes","chatId","number","messageId","object","isRequired","openMedia","func","defaultProps"],"mappings":"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","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport classNames from 'classnames';\nimport RoomIcon from '@material-ui/icons/Room';\nimport { getLocationId } from '../../../Utils/Message';\nimport { getSrc } from '../../../Utils/File';\nimport { LOCATION_HEIGHT, LOCATION_SCALE, LOCATION_WIDTH, LOCATION_ZOOM } from '../../../Constants';\nimport FileStore from '../../../Stores/FileStore';\nimport './Location.css';\n\nclass Location extends React.Component {\n    componentDidMount() {\n        FileStore.on('clientUpdateLocationBlob', this.onClientUpdateLocationBlob);\n    }\n\n    componentWillUnmount() {\n        FileStore.off('clientUpdateLocationBlob', this.onClientUpdateLocationBlob);\n    }\n\n    onClientUpdateLocationBlob = update => {\n        const { fileId } = update;\n        const { location, width, height, zoom, scale } = this.props;\n\n        const locationId = getLocationId(location, width, height, zoom, scale);\n        const file = FileStore.getLocationFile(locationId);\n        if (!file) return;\n\n        if (file.id === fileId) {\n            this.forceUpdate();\n        }\n    };\n\n    handleClick = event => {\n        event.stopPropagation();\n    };\n\n    render() {\n        const { location, width, height, zoom, scale, type, style, title, caption } = this.props;\n        if (!location) return null;\n\n        const locationId = getLocationId(location, width, height, zoom, scale);\n        const file = FileStore.getLocationFile(locationId);\n        const src = getSrc(file);\n\n        const { longitude, latitude } = location;\n        const source = `https://maps.google.com/?q=${latitude},${longitude}`;\n\n        const locationStyle = {\n            width,\n            height,\n            ...style\n        };\n\n        return (\n            <div\n                className={classNames('location', {\n                    'location-message': type === 'message',\n                    'location-venue': type === 'venue',\n                    'location-title': title,\n                    'location-caption': caption\n                })}\n                style={locationStyle}>\n                <a href={source} target='_blank' rel='noopener noreferrer' onClick={this.handleClick}>\n                    <div className='location-wrapper'>\n                        <img className='location-image' draggable={false} alt={source} src={src} />\n                        <div className='location-icon'>\n                            <RoomIcon fontSize='large' color='primary' />\n                        </div>\n                    </div>\n                </a>\n            </div>\n        );\n    }\n}\n\nLocation.propTypes = {\n    chatId: PropTypes.number,\n    messageId: PropTypes.number,\n    location: PropTypes.object.isRequired,\n    openMedia: PropTypes.func,\n\n    width: PropTypes.number,\n    height: PropTypes.number,\n    zoom: PropTypes.number,\n    scale: PropTypes.number\n};\n\nLocation.defaultProps = {\n    width: LOCATION_WIDTH,\n    height: LOCATION_HEIGHT,\n    zoom: LOCATION_ZOOM,\n    scale: LOCATION_SCALE\n};\n\nexport default Location;\n"]},"metadata":{},"sourceType":"module"}