{"ast":null,"code":"import _classCallCheck from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\n\n/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport { TYPING_OUTPUT_INTERVAL_S } from '../Constants';\nimport TdLibController from '../Controllers/TdLibController';\n\nvar OutputTypingManager =\n/*#__PURE__*/\nfunction () {\n  function OutputTypingManager(chatId) {\n    _classCallCheck(this, OutputTypingManager);\n\n    this.chatId = chatId;\n    this.lastAction = null;\n  }\n\n  _createClass(OutputTypingManager, [{\n    key: \"setTyping\",\n    value: function setTyping(action) {\n      if (!this.chatId) return;\n\n      if (this.lastAction && this.lastAction['@type'] === action['@type']) {\n        var now = new Date();\n        now.setSeconds(now.getSeconds() - TYPING_OUTPUT_INTERVAL_S);\n\n        if (this.lastTypingDate && this.lastTypingDate > now) {\n          return;\n        }\n      }\n\n      this.lastAction = action;\n      this.lastTypingDate = new Date();\n      TdLibController.send({\n        '@type': 'sendChatAction',\n        chat_id: this.chatId,\n        action: action\n      });\n    }\n  }]);\n\n  return OutputTypingManager;\n}();\n\nexport default OutputTypingManager;","map":{"version":3,"sources":["/Users/wubenqi/nebula-chat/telegram-react/src/Utils/OutputTypingManager.js"],"names":["TYPING_OUTPUT_INTERVAL_S","TdLibController","OutputTypingManager","chatId","lastAction","action","now","Date","setSeconds","getSeconds","lastTypingDate","send","chat_id"],"mappings":";;;AAAA;;;;;;AAOA,SAASA,wBAAT,QAAyC,cAAzC;AACA,OAAOC,eAAP,MAA4B,gCAA5B;;IAEMC,mB;;;AACF,+BAAYC,MAAZ,EAAoB;AAAA;;AAChB,SAAKA,MAAL,GAAcA,MAAd;AACA,SAAKC,UAAL,GAAkB,IAAlB;AACH;;;;8BAESC,M,EAAQ;AACd,UAAI,CAAC,KAAKF,MAAV,EAAkB;;AAElB,UAAI,KAAKC,UAAL,IAAmB,KAAKA,UAAL,CAAgB,OAAhB,MAA6BC,MAAM,CAAC,OAAD,CAA1D,EAAqE;AACjE,YAAIC,GAAG,GAAG,IAAIC,IAAJ,EAAV;AACAD,QAAAA,GAAG,CAACE,UAAJ,CAAeF,GAAG,CAACG,UAAJ,KAAmBT,wBAAlC;;AACA,YAAI,KAAKU,cAAL,IAAuB,KAAKA,cAAL,GAAsBJ,GAAjD,EAAsD;AAClD;AACH;AACJ;;AAED,WAAKF,UAAL,GAAkBC,MAAlB;AACA,WAAKK,cAAL,GAAsB,IAAIH,IAAJ,EAAtB;AAEAN,MAAAA,eAAe,CAACU,IAAhB,CAAqB;AACjB,iBAAS,gBADQ;AAEjBC,QAAAA,OAAO,EAAE,KAAKT,MAFG;AAGjBE,QAAAA,MAAM,EAAEA;AAHS,OAArB;AAKH;;;;;;AAGL,eAAeH,mBAAf","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { TYPING_OUTPUT_INTERVAL_S } from '../Constants';\nimport TdLibController from '../Controllers/TdLibController';\n\nclass OutputTypingManager {\n    constructor(chatId) {\n        this.chatId = chatId;\n        this.lastAction = null;\n    }\n\n    setTyping(action) {\n        if (!this.chatId) return;\n\n        if (this.lastAction && this.lastAction['@type'] === action['@type']) {\n            let now = new Date();\n            now.setSeconds(now.getSeconds() - TYPING_OUTPUT_INTERVAL_S);\n            if (this.lastTypingDate && this.lastTypingDate > now) {\n                return;\n            }\n        }\n\n        this.lastAction = action;\n        this.lastTypingDate = new Date();\n\n        TdLibController.send({\n            '@type': 'sendChatAction',\n            chat_id: this.chatId,\n            action: action\n        });\n    }\n}\n\nexport default OutputTypingManager;\n"]},"metadata":{},"sourceType":"module"}