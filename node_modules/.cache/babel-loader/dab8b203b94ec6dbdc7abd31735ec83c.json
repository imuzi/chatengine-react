{"ast":null,"code":"import _slicedToArray from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _regeneratorRuntime from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/wubenqi/nebula-chat/telegram-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/wubenqi/nebula-chat/telegram-react/src/Components/Message/Media/WebPage.js\";\n\n/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport SvgIcon from '@material-ui/core/SvgIcon';\nimport Animation from './Animation';\nimport Audio from './Audio';\nimport Document from './Document';\nimport Photo from './Photo';\nimport Sticker, { StickerSourceEnum } from './Sticker';\nimport Video from './Video';\nimport VideoNote from './VideoNote';\nimport VoiceNote from './VoiceNote';\nimport { getSize } from '../../../Utils/Common';\nimport { getSrc } from '../../../Utils/File';\nimport { openInstantView } from '../../../Actions/InstantView';\nimport { PHOTO_DISPLAY_EXTRA_SMALL_SIZE, PHOTO_DISPLAY_SIZE, PHOTO_DISPLAY_SMALL_SIZE, PHOTO_SIZE } from '../../../Constants';\nimport MessageStore from '../../../Stores/MessageStore';\nimport './WebPage.css';\n\nvar WebPage =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(WebPage, _React$Component);\n\n  function WebPage() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, WebPage);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(WebPage)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.getMedia = function () {\n      var _this$props = _this.props,\n          chatId = _this$props.chatId,\n          messageId = _this$props.messageId,\n          size = _this$props.size,\n          displaySize = _this$props.displaySize,\n          displaySmallSize = _this$props.displaySmallSize,\n          displayExtraSmallSize = _this$props.displayExtraSmallSize,\n          openMedia = _this$props.openMedia;\n      var message = MessageStore.get(chatId, messageId);\n      if (!message) return null;\n      var content = message.content;\n      if (!content) return null;\n      var web_page = content.web_page;\n      if (!web_page) return null;\n      var site_name = web_page.site_name,\n          title = web_page.title,\n          description = web_page.description,\n          url = web_page.url,\n          photo = web_page.photo,\n          animation = web_page.animation,\n          video = web_page.video,\n          audio = web_page.audio,\n          document = web_page.document,\n          voice_note = web_page.voice_note,\n          video_note = web_page.video_note,\n          sticker = web_page.sticker,\n          type = web_page.type;\n\n      if (sticker) {\n        return [null, React.createElement(Sticker, {\n          chatId: chatId,\n          messageId: messageId,\n          sticker: sticker,\n          openMedia: openMedia,\n          source: StickerSourceEnum.MESSAGE,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 65\n          },\n          __self: this\n        })];\n      }\n\n      if (voice_note) {\n        return [null, React.createElement(VoiceNote, {\n          chatId: chatId,\n          messageId: messageId,\n          voiceNote: voice_note,\n          openMedia: openMedia,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 78\n          },\n          __self: this\n        })];\n      }\n\n      if (video_note) {\n        return [null, React.createElement(VideoNote, {\n          chatId: chatId,\n          messageId: messageId,\n          videoNote: video_note,\n          openMedia: openMedia,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        })];\n      }\n\n      if (audio) {\n        return [null, React.createElement(Audio, {\n          chatId: chatId,\n          messageId: messageId,\n          audio: audio,\n          openMedia: openMedia,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90\n          },\n          __self: this\n        })];\n      }\n\n      if (document) {\n        return [null, React.createElement(Document, {\n          chatId: chatId,\n          messageId: messageId,\n          document: document,\n          openMedia: openMedia,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94\n          },\n          __self: this\n        })];\n      }\n\n      if (animation) {\n        var animationSrc = getSrc(animation.animation);\n\n        if (animationSrc || animation.thumbnail) {\n          return [null, React.createElement(Animation, {\n            chatId: chatId,\n            messageId: messageId,\n            animation: animation,\n            openMedia: openMedia,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 102\n            },\n            __self: this\n          })];\n        }\n      }\n\n      if (video) {\n        if (video.thumbnail) {\n          return [null, React.createElement(Video, {\n            chatId: chatId,\n            messageId: messageId,\n            video: video,\n            openMedia: openMedia,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 109\n            },\n            __self: this\n          })];\n        }\n      }\n\n      if (photo) {\n        var photoSize = getSize(photo.sizes, size);\n        var smallPhoto = (type === 'article' || type === 'photo') && (site_name || title || description) && photoSize && photoSize.width === photoSize.height;\n        var extraSmallPhoto = smallPhoto && (!description || description.length < 50);\n        var style = smallPhoto || extraSmallPhoto ? {\n          float: 'right',\n          marginLeft: 6\n        } : {};\n        return [smallPhoto ? React.createElement(Photo, {\n          displaySize: extraSmallPhoto ? displayExtraSmallSize : displaySmallSize,\n          style: style,\n          chatId: chatId,\n          messageId: messageId,\n          photo: photo,\n          openMedia: openMedia,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        }) : null, !smallPhoto ? React.createElement(Photo, {\n          chatId: chatId,\n          messageId: messageId,\n          photo: photo,\n          openMedia: openMedia,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }) : null];\n      }\n\n      return [null, null];\n    };\n\n    _this.handleInstantViewClick =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(event) {\n        var _this$props2, chatId, messageId, message, content, web_page, url;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n                event.stopPropagation();\n                _this$props2 = _this.props, chatId = _this$props2.chatId, messageId = _this$props2.messageId;\n                message = MessageStore.get(chatId, messageId);\n\n                if (message) {\n                  _context.next = 6;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", null);\n\n              case 6:\n                content = message.content;\n\n                if (content) {\n                  _context.next = 9;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", null);\n\n              case 9:\n                web_page = content.web_page;\n\n                if (web_page) {\n                  _context.next = 12;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", null);\n\n              case 12:\n                url = web_page.url;\n                openInstantView(url);\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    return _this;\n  }\n\n  _createClass(WebPage, [{\n    key: \"getWebPage\",\n    value: function getWebPage() {\n      var _this$props3 = this.props,\n          chatId = _this$props3.chatId,\n          messageId = _this$props3.messageId,\n          t = _this$props3.t;\n      var message = MessageStore.get(chatId, messageId);\n      if (!message) return null;\n      var content = message.content;\n      if (!content) return null;\n      var web_page = content.web_page;\n      if (!web_page) return null;\n      var description = web_page.description,\n          instant_view_version = web_page.instant_view_version,\n          site_name = web_page.site_name,\n          title = web_page.title;\n      var webPageContent = React.createElement(React.Fragment, null, site_name && React.createElement(\"div\", {\n        className: \"web-page-site-name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, site_name), title && React.createElement(\"div\", {\n        className: \"web-page-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, title), description && React.createElement(\"div\", {\n        className: \"web-page-description\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, description));\n\n      var _this$getMedia = this.getMedia(),\n          _this$getMedia2 = _slicedToArray(_this$getMedia, 2),\n          webPageMediaTop = _this$getMedia2[0],\n          webPageMediaBottom = _this$getMedia2[1];\n\n      var webPageInstantView = instant_view_version > 0 && React.createElement(Button, {\n        variant: \"outlined\",\n        color: \"primary\",\n        classes: {\n          outlinedPrimary: 'message-control',\n          disabled: 'message-control-disabled'\n        },\n        fullWidth: true,\n        onClick: this.handleInstantViewClick,\n        className: \"web-page-button\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(SvgIcon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(\"path\", {\n        d: \"M10.5159727,16.7438514 C10.1741929,18.1203636 10.687342,18.4055299 11.6053255,17.4005852 L15.4613785,12.9698209 C16.3535455,11.8808642 16.1300862,11.0059438 14.8452805,10.7872179 L12.9861121,10.4429102 L12.9861121,10.4429102 C12.8775019,10.4227962 12.8057616,10.3184447 12.8258756,10.2098345 C12.8265392,10.2062511 12.8273007,10.2026864 12.8281591,10.1991446 L13.5436135,7.24719783 C13.8863521,5.8619451 13.3150978,5.61107807 12.4582164,6.59275159 C11.2270125,7.98097123 10.2913754,9.02966176 9.65130514,9.73882318 C9.42814828,9.98606827 9.06894462,10.3719875 8.57369417,10.8965808 C7.48829706,12.1010165 8.05955136,12.9745105 9.31498713,13.1932365 L11.0917769,13.5117472 L11.0917769,13.5117472 C11.2005008,13.5312372 11.2728391,13.6351751 11.253349,13.743899 C11.2525988,13.7480841 11.2517153,13.7522442 11.2506999,13.756373 L10.5159727,16.7438514 Z\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      })), t('InstantView'));\n      return React.createElement(React.Fragment, null, webPageMediaTop, webPageContent, webPageMediaBottom, webPageInstantView);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var meta = this.props.meta;\n      return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n        className: \"web-page\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"border\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"web-page-wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, this.getWebPage())), meta);\n    }\n  }]);\n\n  return WebPage;\n}(React.Component);\n\nWebPage.propTypes = {\n  chatId: PropTypes.number.isRequired,\n  messageId: PropTypes.number.isRequired,\n  size: PropTypes.number,\n  displaySize: PropTypes.number,\n  displaySmallSize: PropTypes.number,\n  displayExtraSmallSize: PropTypes.number,\n  openMedia: PropTypes.func\n};\nWebPage.defaultProps = {\n  size: PHOTO_SIZE,\n  displaySize: PHOTO_DISPLAY_SIZE,\n  displaySmallSize: PHOTO_DISPLAY_SMALL_SIZE,\n  displayExtraSmallSize: PHOTO_DISPLAY_EXTRA_SMALL_SIZE\n};\nexport default withTranslation()(WebPage);","map":{"version":3,"sources":["/Users/wubenqi/nebula-chat/telegram-react/src/Components/Message/Media/WebPage.js"],"names":["React","PropTypes","withTranslation","Button","SvgIcon","Animation","Audio","Document","Photo","Sticker","StickerSourceEnum","Video","VideoNote","VoiceNote","getSize","getSrc","openInstantView","PHOTO_DISPLAY_EXTRA_SMALL_SIZE","PHOTO_DISPLAY_SIZE","PHOTO_DISPLAY_SMALL_SIZE","PHOTO_SIZE","MessageStore","WebPage","getMedia","props","chatId","messageId","size","displaySize","displaySmallSize","displayExtraSmallSize","openMedia","message","get","content","web_page","site_name","title","description","url","photo","animation","video","audio","document","voice_note","video_note","sticker","type","MESSAGE","animationSrc","thumbnail","photoSize","sizes","smallPhoto","width","height","extraSmallPhoto","length","style","float","marginLeft","handleInstantViewClick","event","preventDefault","stopPropagation","t","instant_view_version","webPageContent","webPageMediaTop","webPageMediaBottom","webPageInstantView","outlinedPrimary","disabled","meta","getWebPage","Component","propTypes","number","isRequired","func","defaultProps"],"mappings":"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","sourcesContent":["/*\n *  Copyright (c) 2018-present, Evgeny Nadymov\n *\n * This source code is licensed under the GPL v.3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { withTranslation } from 'react-i18next';\nimport Button from '@material-ui/core/Button';\nimport SvgIcon from '@material-ui/core/SvgIcon';\nimport Animation from './Animation';\nimport Audio from './Audio';\nimport Document from './Document';\nimport Photo from './Photo';\nimport Sticker, { StickerSourceEnum } from './Sticker';\nimport Video from './Video';\nimport VideoNote from './VideoNote';\nimport VoiceNote from './VoiceNote';\nimport { getSize } from '../../../Utils/Common';\nimport { getSrc } from '../../../Utils/File';\nimport { openInstantView } from '../../../Actions/InstantView';\nimport {\n    PHOTO_DISPLAY_EXTRA_SMALL_SIZE,\n    PHOTO_DISPLAY_SIZE,\n    PHOTO_DISPLAY_SMALL_SIZE,\n    PHOTO_SIZE\n} from '../../../Constants';\nimport MessageStore from '../../../Stores/MessageStore';\nimport './WebPage.css';\n\nclass WebPage extends React.Component {\n    getMedia = () => {\n        const { chatId, messageId, size, displaySize, displaySmallSize, displayExtraSmallSize, openMedia } = this.props;\n\n        const message = MessageStore.get(chatId, messageId);\n        if (!message) return null;\n\n        const { content } = message;\n        if (!content) return null;\n\n        const { web_page } = content;\n        if (!web_page) return null;\n\n        const {\n            site_name,\n            title,\n            description,\n            url,\n            photo,\n            animation,\n            video,\n            audio,\n            document,\n            voice_note,\n            video_note,\n            sticker,\n            type\n        } = web_page;\n\n        if (sticker) {\n            return [\n                null,\n                <Sticker\n                    chatId={chatId}\n                    messageId={messageId}\n                    sticker={sticker}\n                    openMedia={openMedia}\n                    source={StickerSourceEnum.MESSAGE}\n                />\n            ];\n        }\n\n        if (voice_note) {\n            return [\n                null,\n                <VoiceNote chatId={chatId} messageId={messageId} voiceNote={voice_note} openMedia={openMedia} />\n            ];\n        }\n\n        if (video_note) {\n            return [\n                null,\n                <VideoNote chatId={chatId} messageId={messageId} videoNote={video_note} openMedia={openMedia} />\n            ];\n        }\n\n        if (audio) {\n            return [null, <Audio chatId={chatId} messageId={messageId} audio={audio} openMedia={openMedia} />];\n        }\n\n        if (document) {\n            return [null, <Document chatId={chatId} messageId={messageId} document={document} openMedia={openMedia} />];\n        }\n\n        if (animation) {\n            const animationSrc = getSrc(animation.animation);\n            if (animationSrc || animation.thumbnail) {\n                return [\n                    null,\n                    <Animation chatId={chatId} messageId={messageId} animation={animation} openMedia={openMedia} />\n                ];\n            }\n        }\n\n        if (video) {\n            if (video.thumbnail) {\n                return [null, <Video chatId={chatId} messageId={messageId} video={video} openMedia={openMedia} />];\n            }\n        }\n\n        if (photo) {\n            const photoSize = getSize(photo.sizes, size);\n            const smallPhoto =\n                (type === 'article' || type === 'photo') &&\n                (site_name || title || description) &&\n                photoSize &&\n                photoSize.width === photoSize.height;\n            const extraSmallPhoto = smallPhoto && (!description || description.length < 50);\n\n            const style =\n                smallPhoto || extraSmallPhoto\n                    ? {\n                          float: 'right',\n                          marginLeft: 6\n                      }\n                    : {};\n\n            return [\n                smallPhoto ? (\n                    <Photo\n                        displaySize={extraSmallPhoto ? displayExtraSmallSize : displaySmallSize}\n                        style={style}\n                        chatId={chatId}\n                        messageId={messageId}\n                        photo={photo}\n                        openMedia={openMedia}\n                    />\n                ) : null,\n                !smallPhoto ? <Photo chatId={chatId} messageId={messageId} photo={photo} openMedia={openMedia} /> : null\n            ];\n        }\n\n        return [null, null];\n    };\n\n    handleInstantViewClick = async event => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { chatId, messageId } = this.props;\n\n        const message = MessageStore.get(chatId, messageId);\n        if (!message) return null;\n\n        const { content } = message;\n        if (!content) return null;\n\n        const { web_page } = content;\n        if (!web_page) return null;\n\n        const { url } = web_page;\n\n        openInstantView(url);\n    };\n\n    getWebPage() {\n        const { chatId, messageId, t } = this.props;\n\n        const message = MessageStore.get(chatId, messageId);\n        if (!message) return null;\n\n        const { content } = message;\n        if (!content) return null;\n\n        const { web_page } = content;\n        if (!web_page) return null;\n\n        const { description, instant_view_version, site_name, title } = web_page;\n\n        const webPageContent = (\n            <>\n                {site_name && <div className='web-page-site-name'>{site_name}</div>}\n                {title && <div className='web-page-title'>{title}</div>}\n                {description && <div className='web-page-description'>{description}</div>}\n            </>\n        );\n        const [webPageMediaTop, webPageMediaBottom] = this.getMedia();\n        const webPageInstantView = instant_view_version > 0 && (\n            <Button\n                variant='outlined'\n                color='primary'\n                classes={{\n                    outlinedPrimary: 'message-control',\n                    disabled: 'message-control-disabled'\n                }}\n                fullWidth\n                onClick={this.handleInstantViewClick}\n                className='web-page-button'>\n                <SvgIcon>\n                    <path d='M10.5159727,16.7438514 C10.1741929,18.1203636 10.687342,18.4055299 11.6053255,17.4005852 L15.4613785,12.9698209 C16.3535455,11.8808642 16.1300862,11.0059438 14.8452805,10.7872179 L12.9861121,10.4429102 L12.9861121,10.4429102 C12.8775019,10.4227962 12.8057616,10.3184447 12.8258756,10.2098345 C12.8265392,10.2062511 12.8273007,10.2026864 12.8281591,10.1991446 L13.5436135,7.24719783 C13.8863521,5.8619451 13.3150978,5.61107807 12.4582164,6.59275159 C11.2270125,7.98097123 10.2913754,9.02966176 9.65130514,9.73882318 C9.42814828,9.98606827 9.06894462,10.3719875 8.57369417,10.8965808 C7.48829706,12.1010165 8.05955136,12.9745105 9.31498713,13.1932365 L11.0917769,13.5117472 L11.0917769,13.5117472 C11.2005008,13.5312372 11.2728391,13.6351751 11.253349,13.743899 C11.2525988,13.7480841 11.2517153,13.7522442 11.2506999,13.756373 L10.5159727,16.7438514 Z' />\n                </SvgIcon>\n                {t('InstantView')}\n            </Button>\n        );\n\n        return (\n            <>\n                {webPageMediaTop}\n                {webPageContent}\n                {webPageMediaBottom}\n                {webPageInstantView}\n            </>\n        );\n    }\n\n    render() {\n        const { meta } = this.props;\n\n        return (\n            <>\n                <div className='web-page'>\n                    <div className='border' />\n                    <div className='web-page-wrapper'>{this.getWebPage()}</div>\n                </div>\n                {meta}\n            </>\n        );\n    }\n}\n\nWebPage.propTypes = {\n    chatId: PropTypes.number.isRequired,\n    messageId: PropTypes.number.isRequired,\n    size: PropTypes.number,\n    displaySize: PropTypes.number,\n    displaySmallSize: PropTypes.number,\n    displayExtraSmallSize: PropTypes.number,\n    openMedia: PropTypes.func\n};\n\nWebPage.defaultProps = {\n    size: PHOTO_SIZE,\n    displaySize: PHOTO_DISPLAY_SIZE,\n    displaySmallSize: PHOTO_DISPLAY_SMALL_SIZE,\n    displayExtraSmallSize: PHOTO_DISPLAY_EXTRA_SMALL_SIZE\n};\n\nexport default withTranslation()(WebPage);\n"]},"metadata":{},"sourceType":"module"}